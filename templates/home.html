{% extends "base.html" %}
{% block title %}Budget{% endblock %}
{% block content %}
  <ul class="unstyled">
  {% for budget in budgets %}
    <li>
      <h2>{{ budget.title|e }} <small>{{ budget.description|e }}</small></h2>
      <table class="table table-striped table-hover">
      {% for key, item in budget.items %}
        <tr>
          <td>{{ item.description|e }}</td>
          <td>
            <form method="post" action="/budgets/{{budget._id}}/transactions/{{key}}">
              <input type="hidden" name="_METHOD" value="DELETE" />
              {{ item.amount|number_format(2)|e }}
              <button class="close">&times;</button>
            </form>
          </td>
        </tr>
      {%endfor %}
        <tr>
          <form method="post" action="/budgets/{{budget._id}}/transactions">
            <td><input type="text" class="input-block-level" name="description" placeholder="Description" /></td>
            <td class="input-append">
              <input type="number" step="0.01" name="amount" placeholder="Amount" />
              <button type="submit" class="btn">Save</button>
            </td>
          </form>
        </tr>
        <tr class="{% if budget.overrun %}error{% else %}info{% endif %}">
          <td></td>
          <td class="span1">
            <form method="post" action="/budgets/{{budget._id}}/transactions">
              <input type="hidden" name="snapshot" value="true" />
              {{ budget.total|number_format(2)|e }}
              <button class="close"><img src="/snapshot.png" /></button>
            </form>
          </td>
        </tr>
      </table>
    </li>
  {% endfor %}
  </ul>
{% endblock %}
